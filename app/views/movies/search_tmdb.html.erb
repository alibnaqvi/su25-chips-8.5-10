<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<h2>Search in TMDb</h2>

<% flash.each do |key, value| %>
  <div class="alert alert-<%= key %> alert-dismissible fade show" role="alert">
    <%= value %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
<% end %>

<div class="search-container mb-4">
  <%= form_tag(search_tmdb_path, method: :get, id: 'tmdb_form') do %>
    <div class="mb-3">
      <label for="movie_title_field" class="form-label">Movie Name (required)</label>
      <%= text_field_tag 'title', params[:title], class: "form-control", id: "movie_title_field", placeholder: "Manhunter" %>
    </div>

    <div class="mb-3">
      <label for="movie_year_field" class="form-label">Release Year (optional)</label>
      <%= text_field_tag 'release_year', params[:release_year], class: "form-control", id: "movie_year_field", placeholder: "1986" %>
    </div>

    <div class="mb-3">
      <div class="form-check form-check-inline">
        <%= radio_button_tag 'language', 'en', params[:language] == 'en', class: "form-check-input", id: "language_en" %>
        <label class="form-check-label" for="language_en">English Only</label>
      </div>
      <div class="form-check form-check-inline">
        <%= radio_button_tag 'language', 'all', params[:language] != 'en', class: "form-check-input", id: "language_all" %>
        <label class="form-check-label" for="language_all">All Languages</label>
      </div>
    </div>

    <div class="mt-3">
      <%= submit_tag 'Search', id: 'tmdb_submit', class: 'btn btn-warning' %>
    </div>
  <% end %>
</div>

<%# This table for results remains the same %>
<% if @movies && @movies.any? %>
  <table id="search_movies" class="table table-striped">
    <thead>
      <tr>
        <th>Title</th>
        <th>Release Date</th>
        <th>Description</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% @movies.each do |movie| %>
        <tr>
          <td><%= movie.title %></td>
          <td><%= movie.release_date %></td>
          <td><%= movie.description %></td>
          <td>
            <%= form_tag add_movie_path, method: :post do %>
              <%= hidden_field_tag :title, movie.title %>
              <%= hidden_field_tag :release_date, movie.release_date %>
              <%= hidden_field_tag :rating, movie.rating %>
              <%= hidden_field_tag :description, movie.description %>
              <%= submit_tag "Add Movie", class: "btn btn-primary" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<%= link_to 'Back to Home', movies_path, class: 'btn btn-primary mt-3' %>